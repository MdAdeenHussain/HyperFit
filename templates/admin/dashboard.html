<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>
<body>

<div class="admin-layout">

  <!-- SIDEBAR -->
  <aside class="admin-sidebar">
    <h2>ADMIN</h2>
    <a href="/admin/dashboard" class="active">Dashboard</a>
    <a href="/admin/users">Users</a>
    <a href="/admin/products">Products</a>
    <a href="/admin/orders">Orders</a>
    <a href="/logout" class="logout">Logout</a>
  </aside>

  <!-- MAIN -->
  <main class="admin-main">
    <h1>Dashboard</h1>

    <div class="stats">
      <div class="card">
        <h3>Total Users</h3>
        <p>{{ total_users }}</p>
      </div>

      <div class="card">
        <h3>Verified Users</h3>
        <p>{{ verified_users }}</p>
      </div>

      <div class="card">
        <h3>Blocked Users</h3>
        <p>{{ blocked_users }}</p>
      </div>

      <div class="card">
        Total Orders<br><strong>{{ total_orders }}</strong>
      </div>

      <div class="card">
        Total Revenue<br><strong>₹{{ total_revenue }}</strong>
      </div>

      <div class="card">
        Net Revenue<br><strong>₹{{ net_revenue }}</strong>
      </div>

      <div class="card">
        Refunds<br><strong>₹{{ refund_amount }}</strong>
      </div>

      <div class="card">
        Weekly Revenue<br><strong>₹{{ weekly_income }}</strong>
      </div>

      <div class="card">
        Cancelled<br><strong>{{ cancelled_orders }}</strong>
      </div>

      <div class="card">
        Returns<br><strong>{{ returned_orders }}</strong>
      </div>
    </div>

    <canvas id="ordersChart"></canvas>
    <canvas id="revenueChart"></canvas>
    <canvas id="paymentChart"></canvas>

  </main>

</div>
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
const ordersLabels = {{ orders_by_day | map(attribute=0) | list | tojson }};
const ordersValues = {{ orders_by_day | map(attribute=1) | list | tojson }};

new Chart(document.getElementById("ordersChart"), {
  type: "line",
  data: {
    labels: ordersLabels,
    datasets: [{
      label: "Orders",
      data: ordersValues,
      borderWidth: 2
    }]
  }
});
</script>

<script>
const revenueLabels = {{ revenue_by_day | map(attribute=0) | list | tojson }};
const revenueValues = {{ revenue_by_day | map(attribute=1) | list | tojson }};

new Chart(document.getElementById("revenueChart"), {
  type: "bar",
  data: {
    labels: revenueLabels,
    datasets: [{
      label: "Revenue",
      data: revenueValues
    }]
  }
});
</script>

<script>
const paymentLabels = {{ payment_split | map(attribute=0) | list | tojson }};
const paymentValues = {{ payment_split | map(attribute=1) | list | tojson }};

new Chart(document.getElementById("paymentChart"), {
  type: "doughnut",
  data: {
    labels: paymentLabels,
    datasets: [{
      data: paymentValues
    }]
  }
});
</script>

<!-- <script>
  const ordersData = {
    labels: {{ orders_by_day | map(attribute=0) | list | tojson }},
    datasets: [{
      label: "Orders",
      data: {{ orders_by_day | map(attribute=1) | list | tojson }},
      borderWidth: 2
    }]
  };

  new Chart(document.getElementById("ordersChart"), {
    type: "line",
    data: ordersData
  });


  new Chart(document.getElementById("revenueChart"), {
    type: "bar",
    data: {
      labels: {{ revenue_by_day | map(attribute=0) | list | tojson }},
      datasets: [{
        label: "Revenue",
        data: {{ revenue_by_day | map(attribute=1) | list | tojson }},
      }]
    }
  });


  new Chart(document.getElementById("paymentChart"), {
    type: "doughnut",
    data: {
      labels: {{ payment_split | map(attribute=0) | list | tojson }},
      datasets: [{
        data: {{ payment_split | map(attribute=1) | list | tojson }},
      }]
    }
  });
</script> -->


<!-- <script>
  const canvas = document.getElementById("revenueChart");
  const ctx = canvas.getContext("2d");

  const labels = JSON.parse(canvas.dataset.labels);
  const values = JSON.parse(canvas.dataset.values);

  new Chart(ctx, {
    type: "line",
    data: {
      labels: labels,
      datasets: [{
        label: "Revenue (₹)",
        data: values,
        borderWidth: 3,
        tension: 0.4
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
</script> -->


</body>
</html>
